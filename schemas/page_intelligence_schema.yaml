type: web
class: Page_intelligence
version: 1.0
group: url
weaviate_instance: spark
description: 'ğŸ“¦ RAW PAGE DATA STORAGE - No vectors needed


  This collection stores raw page intelligence data WITHOUT embeddings.


  ARCHITECTURE:

  - Cloud: Stores raw data from web crawling (vectorless for efficiency)

  - Local: Backup of cloud data (vectorless for fast sync)

  - Page_source: Built FROM this data WITH local embeddings


  WORKFLOW:

  1. Cloud crawler â†’ Page_intelligence (cloud, no vectors)

  2. Nightly backup â†’ Page_intelligence (local, no vectors)

  3. Processing factory â†’ Page_source (local, WITH vectors)


  Why no vectors?

  âœ… Faster backup (no vector transfer)

  âœ… Cheaper storage (no vector index)

  âœ… Vectors added downstream in Page_source

  '
vectorizer: none
multiTenancyConfig:
  enabled: true
  autoTenantActivation: true
  autoTenantCreation: true
invertedIndexConfig:
  bm25:
    b: 0.75
    k1: 1.2
  cleanupIntervalSeconds: 60
  indexTimestamps: false
  indexPropertyLength: false
  indexNullState: true
  stopwords:
    preset: en
    additions: []
    removals: []
schemaConfig:
  autoSchemaEnabled: false
properties:
- name: success
  dataType:
  - boolean
  description: Module-level success indicator - true if intelligence was created successfully
  indexFilterable: true
  sets:
  - standard
  tags:
  - technical
  - quality
- name: url
  dataType:
  - text
  description: Page URL
  indexFilterable: true
  indexSearchable: true
  tokenization: field
  moduleConfig:
    text2vec-transformers:
      skip: true
  sets:
  - standard
  tags:
  - identity
- name: domain
  dataType:
  - text
  description: Domain extracted from URL
  indexFilterable: true
  indexSearchable: true
  tokenization: field
  moduleConfig:
    text2vec-transformers:
      skip: true
  sets:
  - standard
  tags:
  - identity
- name: path
  dataType:
  - text
  description: URL path component
  indexFilterable: true
  indexSearchable: true
  tokenization: field
  moduleConfig:
    text2vec-transformers:
      skip: true
  sets:
  - standard
  tags:
  - identity
  - technical
- name: title
  dataType:
  - text
  description: Page title
  indexFilterable: true
  indexSearchable: true
  tokenization: word
  sets:
  - standard
  tags:
  - content
  - metadata
- name: page_type
  dataType:
  - text
  description: Classified page type (homepage, product, about, etc.)
  indexFilterable: true
  indexSearchable: true
  tokenization: field
  sets:
  - standard
  tags:
  - classification
  - metadata
- name: business_value
  dataType:
  - number
  description: Business value score (0.0-1.0)
  indexFilterable: true
  sets:
  - standard
  tags:
  - scoring
  - metadata
- name: content_category
  dataType:
  - text
  description: Content category classification
  indexFilterable: true
  indexSearchable: true
  tokenization: field
  sets:
  - standard
  tags:
  - classification
  - metadata
- name: research_relevance
  dataType:
  - number
  description: Research relevance score (0.0-1.0) - DEPRECATED, use tenant_group_relevance + tenant_relevance
  indexFilterable: true
  sets:
  - standard
  tags:
  - scoring
  - metadata
  - deprecated
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Issue #571 + #572: Enhanced URL Pattern Analysis & Prioritized Scraping
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
- name: tenant_group_relevance
  dataType:
  - number
  description: Relevance score from tenant_group url_patterns (0.0-0.8). Applied universally across all tenants in the group.
  indexFilterable: true
  sets:
  - standard
  tags:
  - scoring
  - metadata
- name: tenant_relevance
  dataType:
  - number
  description: Relevance score from tenant-specific url_patterns (0.0-1.0). Tenant-customized scoring.
  indexFilterable: true
  sets:
  - standard
  tags:
  - scoring
  - metadata
- name: scrape_priority
  dataType:
  - number
  description: Combined priority score for scraping order (0.0-1.0). Higher = scrape sooner.
  indexFilterable: true
  sets:
  - standard
  tags:
  - scoring
  - scraping
- name: scrape_status
  dataType:
  - text
  description: |
    Scraping status enum (Issue #667). Values from pom_core.models.ScrapeStatus:
    - success: Page scraped successfully
    - partial: Some content retrieved, incomplete
    - pending: Not yet attempted
    - queued: In processing queue
    - retry_scheduled: Will retry later
    - failed: Generic failure
    - skipped: Intentionally skipped
    - blocked: Access blocked (WAF, bot protection)
    - error: Processing error
    - permanent_failure: Unrecoverable (404, 410)
    - excluded: Excluded from processing
  indexFilterable: true
  tokenization: field
  indexSearchable: false
  moduleConfig:
    text2vec-transformers:
      skip: true
  sets:
  - standard
  tags:
  - scraping
  - processing
- name: scraped_at
  dataType:
  - int
  description: Unix timestamp when page was scraped (null if not yet scraped)
  indexFilterable: true
  sets:
  - standard
  tags:
  - scraping
  - temporal
- name: skip_reason
  dataType:
  - text
  description: Legacy skip reason (deprecated, use error_category). Values - threshold, content_type, browser_required, antipattern, error
  indexFilterable: true
  tokenization: field
  indexSearchable: false
  moduleConfig:
    text2vec-transformers:
      skip: true
  sets:
  - extended
  tags:
  - scraping
  - metadata
  - deprecated
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Issue #667: Enhanced Error Categorization for Intelligent Routing
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
- name: error_category
  dataType:
  - text
  description: |
    Detailed error categorization (Issue #667). Values from pom_core.models.ErrorCategory:
    Connection: connection_refused, connection_reset, connection_timeout, dns_failure, ssl_handshake_failed
    VPN/Network: vpn_blocked, proxy_error, network_unreachable
    HTTP 4xx: http_400_bad_request, http_401_unauthorized, http_403_forbidden, http_404_not_found, http_429_rate_limited
    HTTP 5xx: http_500_server_error, http_502_bad_gateway, http_503_service_unavailable, http_504_gateway_timeout
    Bot Protection: bot_protection_cloudflare, bot_protection_akamai, bot_protection_generic, captcha_required
    Content: empty_response, content_too_short, non_html_content
    Timeout: read_timeout, total_timeout, playwright_timeout
  indexFilterable: true
  tokenization: field
  indexSearchable: false
  moduleConfig:
    text2vec-transformers:
      skip: true
  sets:
  - standard
  tags:
  - scraping
  - error
  - routing
- name: routing_recommendation
  dataType:
  - text
  description: |
    Recommended routing strategy (Issue #667). Values from pom_core.models.RoutingRecommendation:
    - standard: Use standard HTTP fetch
    - playwright: Use Playwright browser rendering
    - residential_proxy: Route through residential proxy
    - different_vpn: Try different VPN exit node
    - direct_connection: Bypass VPN, use direct connection
    - delay_and_retry: Wait and retry (rate limiting)
    - skip_domain: Skip this domain entirely
    - manual_review: Requires manual investigation
  indexFilterable: true
  tokenization: field
  indexSearchable: false
  moduleConfig:
    text2vec-transformers:
      skip: true
  sets:
  - extended
  tags:
  - scraping
  - routing
- name: last_error
  dataType:
  - text
  description: Last error message or code encountered during scraping
  indexFilterable: false
  indexSearchable: false
  tokenization: field
  moduleConfig:
    text2vec-transformers:
      skip: true
  sets:
  - extended
  tags:
  - scraping
  - error
- name: error_count
  dataType:
  - int
  description: Number of consecutive errors for this URL (resets on success)
  indexFilterable: true
  sets:
  - extended
  tags:
  - scraping
  - error
- name: detected_content_type
  dataType:
  - text
  description: Detected content type (text_html, document, video, audio, image, structured_data)
  indexFilterable: true
  tokenization: field
  indexSearchable: false
  moduleConfig:
    text2vec-transformers:
      skip: true
  sets:
  - standard
  tags:
  - classification
  - metadata
- name: likely_needs_browser
  dataType:
  - boolean
  description: Whether this URL likely requires browser rendering (SPA/JavaScript detection)
  indexFilterable: true
  sets:
  - standard
  tags:
  - technical
  - scraping
- name: relevance_details
  dataType:
  - object
  description: Detailed breakdown of relevance scoring
  indexFilterable: false
  sets:
  - extended
  tags:
  - scoring
  - metadata
  nestedProperties:
  - name: patterns_matched
    dataType:
    - text[]
    description: URL patterns that matched
  - name: antipatterns_matched
    dataType:
    - text[]
    description: Antipatterns that matched (reduces score)
  - name: structural_modifier
    dataType:
    - number
    description: Structural score modifier (-0.15 to +0.1)
  - name: pattern_source
    dataType:
    - text
    description: Source of highest matching pattern (tenant, tenant_group, universal)
- name: source_sitemap
  dataType:
  - text
  description: Source sitemap URL if discovered via sitemap
  indexFilterable: true
  tokenization: field
  moduleConfig:
    text2vec-transformers:
      skip: true
  sets:
  - standard
  tags:
  - technical
  - source
- name: discovery_method
  dataType:
  - text
  description: Method used to discover this URL
  indexFilterable: true
  tokenization: field
  sets:
  - standard
  tags:
  - technical
  - metadata
- name: features
  dataType:
  - object
  description: URL features and metadata
  indexFilterable: false
  sets:
  - extended
  tags:
  - technical
  - metadata
  nestedProperties:
  - name: is_homepage
    dataType:
    - boolean
    description: Whether this is a homepage URL
  - name: is_deep_page
    dataType:
    - boolean
    description: Whether this is a deep page (not homepage)
  - name: path_length
    dataType:
    - int
    description: Number of path segments
  - name: path_segments
    dataType:
    - int
    description: Number of path segments in URL
  - name: has_query_params
    dataType:
    - boolean
    description: Whether URL has query parameters
  - name: has_fragment
    dataType:
    - boolean
    description: Whether URL has a fragment identifier
  - name: has_dates
    dataType:
    - boolean
    description: Whether URL contains date patterns
  - name: has_numbers
    dataType:
    - boolean
    description: Whether URL contains numbers
  - name: file_extension
    dataType:
    - text
    description: File extension if present
  - name: content_length
    dataType:
    - int
    description: Content length if available
- name: enrichment
  dataType:
  - text
  description: 'Enrichment data from lightweight page probes (stored as JSON string).

    Contains head_probe and http_security_headers enricher outputs.

    '
  indexFilterable: false
  indexSearchable: false
  tokenization: field
  moduleConfig:
    text2vec-transformers:
      skip: true
  sets:
  - extended
  tags:
  - technical
  - enrichment
- name: language
  dataType:
  - text
  description: ISO language code (e.g., en, it)
  indexFilterable: true
  tokenization: field
  indexSearchable: false
  moduleConfig:
    text2vec-transformers:
      skip: true
  sets:
  - standard
  tags:
  - content
  - metadata
- name: crawled_at
  dataType:
  - int
  description: Unix seconds when page was crawled
  indexFilterable: true
  sets:
  - standard
  tags:
  - processing
  - temporal
- name: processing_version
  dataType:
  - text
  description: Pipeline version that produced this record
  indexFilterable: true
  tokenization: field
  indexSearchable: false
  moduleConfig:
    text2vec-transformers:
      skip: true
  sets:
  - standard
  tags:
  - technical
  - versioning
- name: http_failure_count
  dataType:
  - int
  description: Number of HTTP fetch failures for this URL (triggers Playwright at 3)
  indexFilterable: true
  sets:
  - extended
  - system
  tags:
  - technical
  - processing
- name: playwright_required
  dataType:
  - boolean
  description: Flag indicating this URL requires Playwright extraction (skip HTTP, use Playwright directly)
  indexFilterable: true
  sets:
  - extended
  - system
  tags:
  - technical
  - processing
collection_name: Page_intelligence
uuid_strategy:
  fields:
  - field: url
    namespace: URL
    description: Primary strategy using URL for deterministic intelligence UUIDs
dependencies:
- type: foundational
data_sources:
  url_collection: domain
collection_groups:
- url_collections
schema_config:
  additional_properties: false
id: Page_intelligence
name: Page Intelligence
# Enrichers disabled for speed - URL validation happens in page_facts
# See pom-core#567 for details
enrichers: []
