id: company_research_analysis
collection: Company_source
name: Company Research Analysis
type: data_card
file: company_research_analysis.yaml
description: >
  Fetch Company_source records with ONLY LLM (analysis) fields from all researchers.
  Optimized for detailed AI-generated insights and qualitative analysis.
  Use this card when you need deep analysis without categorical classifications.

# Tagging system
tags:
  - research
  - llm-fields
  - analysis
  - insights
  - company-intelligence
  - qualitative

target_scope: company_intelligence
executor: graphql

# ðŸŽ¨ Frontend Display Control
display: true  # User-facing card for LLM analysis
relationship_support: true

personas:
  - "*"

parameters:
  type: graphql

  # Root collection
  collection: Company_source

  # Use reverse traversal to fetch researcher collections
  relationship_traversal: true
  dynamic_templates: true

  # Fetch one or more companies (supports large batch operations)
  limit: 10000
  limit_default: 10000

# ðŸŽ¯ TAG-BASED FILTERING - Fetch ONLY LLM fields for detailed analysis
# No explicit fields - let the system resolve based on tags!
fields: {}

# Specify tags to include for all researcher collections
field_tags:
  - LLM

# Collection configuration: Company_source with auto-discovered nested references
# System automatically discovers ALL 10 researcher references from Company_source schema
# field_tags=[LLM] filters to only LLM fields across all discovered references
collections:
  - collection: Company_source
    uses_field_set: extended  # Get Company_source context fields (description, overview, etc.)
    required: true
    # âœ… AUTO-DISCOVERY: No need to list all researcher collections
    # GraphQLGenerator automatically discovers all nested references:
    # financial, industry, product, customer, leadership, competitor, partner, risk, journalist, social
    # field_tags=[LLM] applied to all discovered references

# Chat integration
chat_integration:
  best_for:
    - "Detailed AI-generated insights and analysis"
    - "Qualitative research reports"
    - "Deep dives into specific companies"
    - "LLM-powered summaries and narratives"

# Query behavior
supports_relationships: true
supports_aggregation: false  # Analysis fields are qualitative, not for aggregation
supports_grouping: false     # LLM fields are descriptive, not categorical
requires_query_text: false

# Performance settings
default_limit: 10   # Lower default due to larger LLM field payloads
max_limit: 100
timeout_seconds: 60

# Related collections
related_collections:
  - Company_source
  - Company_research_financial
  - Company_research_industry
  - Company_research_product
  - Company_research_customer
  - Company_research_leadership
  - Company_research_competitor
  - Company_research_partner
  - Company_research_risk
  - Company_research_journalist
  - Company_research_social

# Documentation
documentation:
  overview: |
    This data card fetches ONLY LLM (analysis) fields using tag-based filtering.
    Optimized for detailed AI-generated insights, qualitative analysis, and narrative reports.
    Larger payload than categorical data - ideal for in-depth research and dossiers.

  tag_strategy: |
    LLM FIELD SELECTION:

    Company_source: uses_field_set='extended' (description, overview, content)
    Researcher collections: field_tags=[LLM]

    This fetches ONLY:
    - Company_source: Extended fields (description, overview for context)
    - Researchers: LLM fields (detailed AI analysis like useCaseLLM, customerIndustrySegmentLLM)

    EXCLUDED:
    - Cat fields (categorical - use company_research_categories instead)
    - Research fields (raw data - use company_research instead)

  usage_examples:
    - name: "Detailed company dossier"
      query: "data_card_id: company_research_analysis, where: {domain: 'example.com'}"
      notes: "Get all LLM insights for comprehensive report"

    - name: "Qualitative research batch"
      query: "data_card_id: company_research_analysis, limit: 10"
      notes: "Deep analysis for multiple companies"

    - name: "AI-generated summary"
      query: "data_card_id: company_research_analysis, where: {accountName: 'Acme Corp'}"
      notes: "All LLM fields for narrative generation"

  comparison:
    company_research: "All fields (Cat + LLM + research) - comprehensive but slower"
    company_research_categories: "Cat fields only - fast and efficient for pivot tables"
    company_research_analysis: "LLM fields only - detailed analysis without categories"

  field_examples:
    LLM_fields:
      - useCaseLLM: "Detailed use case descriptions"
      - customerSegmentLLM: "AI-generated customer segment analysis"
      - customerIndustrySegmentLLM: "Industry-specific insights"
      - valueProposition: "Product/service value analysis"
      - All other *LLM suffixed fields across researchers

